<!DOCTYPE html>
<html>
<head>
    <title>VRSpring之家</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <meta http-equiv="x-ua-compatible" content="IE=edge"/>
    <style>
        @-ms-viewport {
            width: device-width;
        }

        @media only screen and (min-device-width: 800px) {
            html {
                overflow: hidden;
            }
        }

        html {
            height: 100%;
        }

        body {
            height: 100%;
            overflow: hidden;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 16px;
            color: #FFFFFF;
            background-color: #000000;
        }
    </style>
    <script>
        var LocString = String(window.document.location.href);
        function GetParamString(str) {
            var rs = new RegExp("(^|)" + str + "=([^&]*)(&|$)", "gi").exec(LocString), tmp;
            if (tmp = rs) {
                return decodeURIComponent(tmp[2]);
            }
            return "";
        }
        document.title = "VRSpring之家-" + GetParamString("title");
    </script>
</head>
<body>

<script src="tour.js"></script>

<div id="pano" style="width:100%;height:100%;">
    <noscript>
        <table style="width:100%;height:100%;">
            <tr style="vertical-align:middle;">
                <td>
                    <div style="text-align:center;">ERROR:<br/><br/>Javascript not activated<br/><br/></div>
                </td>
            </tr>
        </table>
    </noscript>
    <script>
        embedpano({
            swf: "tour.swf",
            xml: GetParamString("tourxml"),
            target: "pano",
            html5: "auto",
            mobilescale: 1.0,
            passQueryParameters: true
        });
        var krpano = document.getElementById("krpanoSWFObject");

        function showmouseinfo() {
//            krpano.set('showerrors',true);
//            krpano.set('xml.url',window.document.location.href)
//            console.log( krpano.get('xml.url'));
//            krpano.call("toupper(xml.url);");
//            console.log( krpano.get('xml.url'));
        }
        function onTopLeftButtonClick() {
            krpano.call("switch(plugin[skin_gyro].enabled); if(plugin[skin_gyro].enabled, skin_showmap(false));");
        }

        function onTopRightButtonClick() {
            krpano.call("webvr.enterVR()");
        }
        function onPreButtonClick() {
            krpano.call("if(skin_settings.thumbs_loop, skin_nextscene_loop(-1), skin_nextscene(-1) );");
        }

        function onNextButtonClick() {
            krpano.call("if(skin_settings.thumbs_loop, skin_nextscene_loop(+1), skin_nextscene(+1) );");
        }
        function hiddenSystemMenu() {
            krpano.call("set(layer[skin_layer].visible,false)");
//            krpano.call("set(layer[skin_splitter_bottom].visible,false)");
//            krpano.call("set(layer[skin_control_bar].visible,false)");
        }

        function addTopLeftButton() {
            krpano.call("addlayer(TopLeftButton);");
            krpano.call("set(layer[TopLeftButton].keep,true)");
            krpano.call("set(layer[TopLeftButton].align,lefttop);");
            krpano.call("set(layer[TopLeftButton].url,'../images/full_active.png');");
            krpano.call("set(layer[TopLeftButton].width,32)");
            krpano.call("set(layer[TopLeftButton].height,32)");
            krpano.call("set(layer[TopLeftButton].x,20)");
            krpano.call("set(layer[TopLeftButton].y,20)");
            krpano.call("set(layer[TopLeftButton].onclick,js(onTopLeftButtonClick()));");
        }
        function addTopRightButton() {
            krpano.call("addlayer(TopRightButton);");
            krpano.call("set(layer[TopRightButton].keep,true)");
            krpano.call("set(layer[TopRightButton].align,righttop);");
            krpano.call("set(layer[TopRightButton].url,'../images/vr.png');");
            krpano.call("set(layer[TopRightButton].width,32)");
            krpano.call("set(layer[TopRightButton].height,32)");
            krpano.call("set(layer[TopRightButton].x,20)");
            krpano.call("set(layer[TopRightButton].y,20)");
            krpano.call("set(layer[TopRightButton].onclick,js(onTopRightButtonClick()));");
            krpano.call("set(fullscreen,true);");
        }

        function addCenterButton() {
            krpano.call("addlayer(CenterButton);");
            krpano.call("set(layer[CenterButton].keep,true)");
            krpano.call("set(layer[CenterButton].edge,center);");
            krpano.call("set(layer[CenterButton].align,center);");
            krpano.call("set(layer[CenterButton].url,'../images/vr_active.png');");
            krpano.call("set(layer[CenterButton].width,32)");
            krpano.call("set(layer[CenterButton].height,32)");
            krpano.call("set(layer[CenterButton].x,0)");
            krpano.call("set(layer[CenterButton].y,45%)");
            krpano.call("set(layer[CenterButton].onclick,js(onTopRightButtonClick()));");
            krpano.call("set(fullscreen,true);");
        }
        function addPreButton() {
            krpano.call("addlayer(PreButton);");
            krpano.call("set(layer[PreButton].keep,true)");
            krpano.call("set(layer[PreButton].align,left);");
            krpano.call("set(layer[PreButton].url,'../images/pre.png');");
            krpano.call("set(layer[PreButton].width,32);");
            krpano.call("set(layer[PreButton].height,32);");
            krpano.call("set(layer[PreButton].x,35%);");
            krpano.call("set(layer[PreButton].y,45%);");
            krpano.call("set(layer[PreButton].onclick,js(onPreButtonClick()));");

        }

        function addNextButton() {
            krpano.call("addlayer(NextButton);");
            krpano.call("set(layer[NextButton].keep,true)");
            krpano.call("set(layer[NextButton].align,right);");
            krpano.call("set(layer[NextButton].url,'../images/next.png');");
            krpano.call("set(layer[NextButton].width,32);");
            krpano.call("set(layer[NextButton].height,32);");
            krpano.call("set(layer[NextButton].x,35%);");
            krpano.call("set(layer[NextButton].y,45%);");
            krpano.call("set(layer[NextButton].onclick,js(onNextButtonClick()));");
        }


        (function addLyer() {
//            krpano.set('debugmode', true);
//            krpano.set('showerrors', true);
            console.log(krpano.get('scene'));
            hiddenSystemMenu();
            addTopLeftButton();
            addTopRightButton();
            addCenterButton();
            addPreButton();
            addNextButton();
        })();

    </script>
</div>

</body>
</html>
